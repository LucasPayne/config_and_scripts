# lfrc - lf configuration file
# lf - Terminal file manager
#
# Resources:
#    man 1 lf
#    https://github.com/gokcehan/lf
#    https://github.com/gokcehan/lf/wiki/
#    https://wiki.archlinux.org/title/Lf

# Include "lfrc_lib" header.
# This allows lf config to be spread across multiple files.
# lfrc_lib/Makefile will generate this header from .lf files.
# note: If lf language had wildcards with would be easier.
source ~/config/lf/lfrc_lib/header

# OPTIONS
#<<<
set shell bash
#todo:?
set ifs ' '
set nodrawbox
set noicons
set ignorecase
set mouse
set sortby natural
set info
set previewer ~/.config/lf/previewer.sh
#lfimg
# set ratios 1:2:3
# set previewer ~/.config/lf/preview_lfimg
# set cleaner ~/.config/lf/clean_lfimg

#>>>

# MAPPINGS
#<<<
# System mappings<<<
# Make Ctrl-Z work as SIGTSTP as usual.
#https://github.com/gokcehan/lf/issues/357
map <c-z> $ kill -TSTP $PPID
#>>>
# z mappings <<<
#
# Defaults:
#    z a: map za set info size:time
#    z h: map zh set hidden!
#    z n: map zn set info
#    z r: map zr set reverse!
#    z s: map zs set info size
#    z t: map zt set info time
# Own
#>>>
# s mappings <<<
# Defaults
#    s n: map sn :set sortby natural; set info
#    s s: map ss :set sortby size; set info size
#    s t: map st :set sortby time; set info time
#    s a: map sa :set sortby atime; set info atime
#    s c: map sc :set sortby ctime; set info ctime
#    s e: map se :set sortby ext; set info
# Own
#    s N:
map sN set sortby name; set info
#>>>
# leader-\ mappings <<<
# Leader key: \
map \\b :set drawbox!
#>>>
# General mappings
map i $LESSOPEN='| ~/.config/lf/previewer.sh %s' less -R $f
map <enter> :func-open
map D mkdir
map T touch

cmd yank-dirname ${{
    dirname -- "$f" | head -c-1 | xclip -i -selection clipboard
}}
cmd yank-path ${{
    printf '%s' "$f" | xclip -i -selection clipboard
}}

# Set wallpaper
cmd wp ${{
    wp "$f"
}}

map f :fzf_jump 0
map F :fzf_jump 1
map <a-f> :fzf_jump 0
map <a-r> :fzf_jump 1
map x :unarchive
map g :top
map w
# Just open a text file.
map e &{{
    for file in $fx ; do
        case $(file --mime-type -Lb $file) in
            text/*)
                v --nostdin "$file"
            ;;
        esac
    done
}}
map <a-y> :yank-path
map <a-j> :down
map <a-k> :up
map <a-l> :open; quit

# Open file
map o :open-file

#todo: O, open without window focus change.
#>>>

# Source auto-generated config
source ~/config/scripts/syncer_files/syncer-lf
